const select=a=>document.querySelector(a),selectAll=a=>document.querySelectorAll(a),input=select('#textInput'),output=select('#textOutput'),inputFull=select('#textFull'),_timer=select('#timer'),_wpm=select('#wpm'),_cpm=select('#cpm'),_errors=select('#errors'),_accuracy=select('#accuracy'),_totalWords=select('#totalWords'),_writtenWords=select('#writtenWords'),modal=select('#ModalCenter'),modalBody=select('.modal-body'),modalClose=selectAll('.modal-close'),modalReload=select('#modalReload'),btnPaly=select('#btnPlay'),btnRefresh=select('#btnRefresh'),soundOn=select('.icon-sound-on'),soundOff=select('.icon-sound-off'),keyClick=select('#keyClick'),keyBeep=select('#keyBeep');let sound=!0;soundOn.addEventListener('click',a=>{a.currentTarget.classList.add('d-none'),soundOff.classList.remove('d-none'),sound=!1}),soundOff.addEventListener('click',a=>{a.currentTarget.classList.add('d-none'),soundOn.classList.remove('d-none'),sound=!0});const allQuotes=[];fetch('js/quotes.json').then(a=>a.json()).then(a=>allQuotes.push(...a)).catch(a=>console.error('Error:',a));const random=a=>a[Math.floor(Math.random()*a.length)];class speedTyping{constructor(){this.index=0,this.words=0,this.errorIndex=0,this.correctIndex=0,this.accuracyIndex=0,this.cpm=0,this.wpm=0,this.interval=null,this.duration=60,this.typing=!1,this.quote=[],this.author=[]}timer(){if('number'!=typeof this.interval){const a=Date.now(),b=a+1e3*this.duration;_timer.innerHTML=`${this.duration}<span class="small">s</span>`,this.interval=setInterval(()=>{const c=Math.round((b-Date.now())/1e3);_timer.innerHTML=`${c}<span class="small">s</span>`,0===c&&(this.stop(),this.finish())},1e3)}}start(){const a=allQuotes.filter(f=>'Easy'!==f.level),b=a.map(f=>f.quote),c=a.map(f=>f.author);this.author=random(c),this.quote=random(b);const d=this.quote.split(' ').filter(f=>f).length;_totalWords.textContent=d,this.timer(),btnPlay.classList.add('active'),input.setAttribute('tabindex','0'),input.removeAttribute('disabled'),input.focus(),input.classList.add('active'),this.typing||(this.typing=!0,input.textContent=this.quote,input.addEventListener('keypress',f=>{f.preventDefault(),f=f||window.event;const g=f.which||f.keyCode,h=String.fromCharCode(g);if(h===this.quote.charAt(this.index)){' '===h&&32===g&&(this.words++,_writtenWords.textContent=this.words),this.index++;const j=this.quote.substring(this.index,this.index+this.quote.length);if(input.textContent=j,output.innerHTML+=h,this.correctIndex++,this.index===this.quote.length)return this.stop(),void this.finish();sound&&(keyClick.currentTime=0,keyClick.play())}else output.innerHTML+=`<span class="text-danger">${h}</span>`,this.errorIndex++,_errors.textContent=this.errorIndex,this.correctIndex--,sound&&(keyBeep.currentTime=0,keyBeep.play());this.cpm=5<this.correctIndex?Math.floor(60*(this.correctIndex/this.duration)):0,_cpm.textContent=this.cpm,this.wpm=Math.round(this.cpm/5),_wpm.textContent=this.wpm,this.accuracyIndex=5<this.correctIndex?Math.round(100*this.correctIndex/this.index):0,0<this.accuracyIndex&&Number.isInteger(this.accuracyIndex)&&(_accuracy.innerHTML=`${this.accuracyIndex}<span class="small">%</span>`)}))}stop(){return clearInterval(this.interval),this.interval=null,this.typing=!1,_timer.textContent='0',btnPaly.remove(),input.remove(),btnRefresh.classList.add('active'),inputFull.classList.remove('d-none'),void(inputFull.innerHTML=`&#8220;${this.quote}&#8221; <span class="d-block small text-muted text-right pr-3">&ndash; ${this.author}</span></div> `)}finish(){modal.style.display='block';const a=this.wpm;let b='';const c=`Your typing speed is <strong>${a}</strong> WPM which equals <strong>${this.cpm}</strong> CPM. You've made a <strong>${this.errorIndex}</strong> mistakes with <strong>${this.accuracyIndex}%</strong> total accuracy.`;b=5<a&&20>a?`<div class="modal-icon my-3"><img src="img/sleeping.svg" class="media-object"></div><div class="media-body p-2"><h4 class="media-heading">So Slow!</h4><p class="lead pt-2">${c} You should do more practice!</p></div>`:20<a&&40>a?`<div class="modal-icon my-3"><img src="img/thinking.svg" class="media-object"></div><div class="media-body p-2"><h4 class="media-heading">About Average!</h4><p class="lead pt-2">${c} You can do better!</p></div>`:40<a&&60>a?`<div class="modal-icon my-3"><img src="img/surprised.svg" class="media-object"></div><div class="media-body p-2"><h4 class="media-heading">Great Job!</h4><p class="lead pt-2">${c} You're doing great!</p></div>`:60<a?`<div class="modal-icon my-3"><img src="img/shocked.svg" class="media-object"></div><div class="media-body p-2"><h4 class="media-heading">Insane!</h4><p class="lead pt-2">${c} You're are Awesome!</p></div>`:`<div class="modal-icon my-3"><img src="img/smart.svg" class="media-object"></div><div class="media-body p-2"><h4 class="media-heading">Hmmm!</h4><p class="lead pt-2">Please stop playing around and start typing!</p></div>`,modalBody.innerHTML=b,modalClose.forEach(d=>d.addEventListener('click',()=>modal.style.display='none')),window.addEventListener('click',d=>d.target===modal?modal.style.display='none':''),modalReload.addEventListener('click',()=>location.reload()),localStorage.setItem('WPM',a)}}const typingTest=new speedTyping;btnPaly.addEventListener('click',()=>typingTest.start()),btnRefresh.addEventListener('click',()=>location.reload());const savedWPM=localStorage.getItem('WPM')||0;select('#result').innerHTML=`<li>${savedWPM}</li>`;